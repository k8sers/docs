# OKE介绍及关键特性说明

![Untitled](Untitled%2042.png)

![Untitled](Untitled%2043.png)

---

## 1. 简介

下面是介绍的PPT（PDF），快速让大家明白OCI提供了什么K8s服务。另外，在本文末尾还有图片版本。

[Container & Kubernetes Runtime Services 公开.pdf](Container__Kubernetes_Runtime_Services_%25E5%2585%25AC%25E5%25BC%2580.pdf)

## 2. 关键特性说明

### 2.1 关于OKE版本

- OKE版本号与K8s版本一一对应，所以OKE版本其实就是K8s版本
- OKE版本分为Cluster集群版本，和worker node上面的版本，他们可以不一致。但worker node版本不能超过cluster版本，也不能落后集群超过2个大版本。
- OKE会**维护3个最新的版本**，更新的周期与K8s更新周期大致一样（可能落后K8s版本数个月），周期大致是半年出一个大版本。下面是很多客户关系的问题：
    - 不再维护的版本是否可以不升级？： 可以保持低版本。 OKE不会强制升级，只能人工升级。但我们建议还是往上升级。
    - 使用不再维护的低版本什么影响？：几乎没影响，你可以继续使用，包括按需扩容出新节点。但Oracle不再维护低版本其实意味着下面的问题。不过也不用过于担心，至今未有客户反馈保留低版本OKE遇到过什么bug。
        - 低版本可能有些bug，范围包括低版本对应的adds-on附加组件，对这些bug支持力度没有新版本支持力度大。
        - 高版本会引入一些新功能/新优化，低版本缺失。 不过也不用过于担心

| Kubernetes Version | Patch release supported by OKE | Upstream Release Date | Upstream End-of-life date | OKE Release Date | OKE End-of-life Date |
| --- | --- | --- | --- | --- | --- |
| 1.28 | 1.28.2 | 2023-09-13 | 2024-10-28 | 2023-12-19 | 30 days after 1.31 OKE Release Date (planned) |
| 1.27 | 1.27.2 | 2023-07-19 | 2024-06-28 | 2023-08-16 | 30 days after 1.30 OKE Release Date (planned) |
| 1.26 | 1.26.7 | 2023-07-19 | 2024-02-28 | 2023-09-12 | 30 days after 1.29 OKE Release Date (planned) |
| 1.26 | 1.26.2 | 2022-12-09 | 2024-02-28 | 2023-04-26 | 2023-10-13 |

最新的支持表格见：[https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengaboutk8sversions.htm#supportedk8sversions](https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengaboutk8sversions.htm#supportedk8sversions)

### 2.2 容器运行时

大部分云厂商的运行时还是containerd， 而OCI用的是cri-o。

对应绝大部分的应用来说，并不需要关心K8s的底层容器运行时，因为他们都符合K8s 的CRI接口，工作负载在任意容器运行时上跑都一个效果。

至今只发现一例案例，就是阿里云的日志上报agent的合并上报模式， 是利用了docker的文件印射接口实现， 导致这个日志agent无法在OCI上使用合并到某一个Pod统一上报模式，只能使用普通模式。

**GPU运行时：**

另外GPU的容器运行时跟Nvidia的驱动有关，OCI只能通过选择GPU的Linux镜像版本来选择CUDA版本。详情见本站的GPU与CUDA版本的文章。

### 2.3 网络模式

网络分为Pod间通讯网络，以及Service的网络

 **a) Service 网络**

OKE的Service网络使用iptables实现，而非主流的ipvs实现。

对业务负载来说，功能都是一样的； 经过性能测试，他们都能达到最大带宽，性能差异不大。

所以不用纠结OKE用的是ipvs还是iptables

**b) Pod网络**

OKE提供2种Pod网络：VCN-Native  与 Flannel 。 当然你也可以这两种都不要， 在adds-on附加组件中把他们卸载掉，安装自己的Pod网络，比如高级的Calico。

### 2.4 Worker Node 镜像

在创建或编辑节点池的时候，我们可以为Worker Node 选择系统镜像，它们被分为2大类，分别是平台镜像和 OKE Worker Node镜像：

![Untitled](Untitled%2044.png)

OKE Worker Node镜像是优化过后的镜像，所以能用这类镜像的时候，尽量选OKE Worker Node镜像。

这里的优化是指已经按照脚本安装好了一些工具，不需要在第一次启动的时候才安装。 而 平台镜像就是用最普通的Oracle Linux去安装各种所需工具，多出了安装的过程。

什么时候用Platform Image呢？ 当镜像本身包含一些bug，甲骨文工程师修复安装脚本 比 重新做一个OKE Worker Node更快，那时候可以快速使用OKE Worker Node的平台镜像来修复。

### 2.5 计费