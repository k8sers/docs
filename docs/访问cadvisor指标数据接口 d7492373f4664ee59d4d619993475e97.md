# 访问cadvisor指标数据接口

本文出于调试用途。 先生成一个K8s管理员账号：

```yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: oke-admin
  namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: oke-admin-crb
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: oke-admin
    namespace: kube-system
```

```bash
kubectl apply -f oke-admin.yaml
kubectl create token oke-admin --duration=999999h -n kube-system
#如果已创建，则查看
kubectl -n kube-system get sa oke-admin -o yaml
kubectl get secrets oke-admin -n kube-system -oyaml
```

记录上面输出的token，放到http的Authorization头中

```bash
curl --cacert ca.crt -H "Authorization: Bearer <token>"  https://<Node的IP>:10250/metrics/cadvisor |grep container_network

curl -k -H "Authorization: Bearer <Token>"  https://127.0.0.1:10250/metrics/cadvisor |grep container_network
```

最后可以拿到cadvisor的指标数据